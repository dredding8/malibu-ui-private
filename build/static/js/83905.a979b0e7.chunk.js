"use strict";(self.webpackChunkvue_dashboard_blueprint=self.webpackChunkvue_dashboard_blueprint||[]).push([[83905],{83905:(e,s,a)=>{a.r(s),a.d(s,{WorkspaceMode:()=>T,default:()=>f});var i=a(89379),l=a(65043),n=a(85791),t=a(29130),o=a(26419),c=a(4173),r=a(25078),d=a(34826),h=a(98934),p=a(47487),m=a(57939),v=a(71965),u=a(7290),A=a(11782),x=a(38846),j=a(212),S=a(99463),y=a(62821),E=a(18399),N=a(85579),C=a(28234),g=a(70579);const I=e=>{const s=l.createElement(n.I,e);return(0,g.jsx)(g.Fragment,{children:s})};let T=function(e){return e.SIMPLE="simple",e.ADVANCED="advanced",e.EXPERT="expert",e}({});const R=(e,s)=>{switch(s.type){case"SET_MODE":return(0,i.A)((0,i.A)({},e),{},{mode:s.payload});case"SET_PASSES":return(0,i.A)((0,i.A)({},e),{},{availablePasses:s.payload});case"SELECT_PASS":return(0,i.A)((0,i.A)({},e),{},{selectedPass:s.payload});case"SELECT_SITE":return(0,i.A)((0,i.A)({},e),{},{selectedSite:s.payload});case"ADD_ALLOCATION":{const a={type:"add",allocation:s.payload,reason:"Manual allocation"};return(0,i.A)((0,i.A)({},e),{},{proposedChanges:[...e.proposedChanges,a],isDirty:!0})}case"REMOVE_ALLOCATION":{const a=e.currentAllocations.find(e=>e.passId===s.payload);if(a){const s={type:"remove",allocation:a,reason:"Manual removal"};return(0,i.A)((0,i.A)({},e),{},{proposedChanges:[...e.proposedChanges,s],isDirty:!0})}return e}case"MODIFY_ALLOCATION":{const a=e.currentAllocations.find(e=>e.passId===s.payload.id);if(a){const l={type:"modify",allocation:(0,i.A)((0,i.A)({},a),s.payload.changes),reason:"Manual modification"};return(0,i.A)((0,i.A)({},e),{},{proposedChanges:[...e.proposedChanges,l],isDirty:!0})}return e}case"SET_VALIDATION_ERRORS":return(0,i.A)((0,i.A)({},e),{},{validationErrors:s.payload});case"TOGGLE_TIMELINE":return(0,i.A)((0,i.A)({},e),{},{showTimeline:!e.showTimeline});case"TOGGLE_CONFLICTS":return(0,i.A)((0,i.A)({},e),{},{showConflicts:!e.showConflicts});case"START_SAVE":return(0,i.A)((0,i.A)({},e),{},{isSaving:!0});case"SAVE_SUCCESS":return(0,i.A)((0,i.A)({},e),{},{isSaving:!1,isDirty:!1,proposedChanges:[]});case"SAVE_ERROR":return(0,i.A)((0,i.A)({},e),{},{isSaving:!1});case"RESET_CHANGES":return(0,i.A)((0,i.A)({},e),{},{proposedChanges:[],isDirty:!1,validationErrors:[]});default:return e}},f=e=>{let{opportunity:s,availableSites:a,onSave:n,onClose:f}=e;const O={satelliteId:s.satellite.id,mode:T.SIMPLE,availablePasses:[],currentAllocations:[],proposedChanges:[],validationErrors:[],isDirty:!1,isSaving:!1,showTimeline:!1,showConflicts:!1,approvalStatus:new Map},[P,_]=(0,l.useReducer)(R,O),[D,L]=(0,l.useState)("all"),[b,w]=(0,l.useState)(24),[M,W]=(0,l.useState)(!0);(0,l.useEffect)(()=>{k()},[s.satellite.id]);const k=async()=>{const e=G(20);_({type:"SET_PASSES",payload:e})},G=e=>{const s=[5,4,3,2],a=new Date;return Array.from({length:e},(e,i)=>{const l=new Date(a.getTime()+90*i*60*1e3),n=5+Math.floor(10*Math.random());return{id:"pass-".concat(i),name:"Pass ".concat(i+1),startTime:l,endTime:new Date(l.getTime()+60*n*1e3),duration:n,elevation:30+60*Math.random(),azimuth:360*Math.random(),quality:s[Math.floor(Math.random()*s.length)],conflictsWith:Math.random()>.7?["pass-".concat(Math.max(0,i-1))]:void 0,requiredResources:["Antenna","Recorder","Processor"],siteCapabilities:[],priority:"normal",classificationLevel:"UNCLASSIFIED"}})},V=(0,l.useMemo)(()=>{let e=[...P.availablePasses];"all"!==D&&(e=e.filter(e=>e.quality===parseInt(D)));const s=new Date(Date.now()+60*b*60*1e3);return e=e.filter(e=>e.startTime<=s),M&&(e=e.filter(e=>{const s=P.currentAllocations.some(s=>s.passId===e.id),a=P.proposedChanges.some(s=>"remove"===s.type&&s.allocation.passId===e.id);return!s||a})),e},[P.availablePasses,P.currentAllocations,P.proposedChanges,D,b,M]),J=(0,l.useMemo)(()=>{let e=[...P.currentAllocations];P.proposedChanges.forEach(s=>{switch(s.type){case"add":e.push(s.allocation);break;case"remove":e=e.filter(e=>e.passId!==s.allocation.passId);break;case"modify":e=e.map(e=>e.passId===s.allocation.passId?s.allocation:e)}});const a=Math.min(100,15*e.length),l=(0,i.A)((0,i.A)({},s),{},{capacityPercentage:a});return(0,N._H)(l)},[s,P.currentAllocations,P.proposedChanges]);return(0,g.jsxs)(t.l,{isOpen:!0,onClose:f,title:(0,g.jsxs)("div",{className:"workspace-header",children:[(0,g.jsx)(I,{icon:E.W.FLOWS}),(0,g.jsxs)("span",{children:["Reallocation Workspace: ",s.name]}),(0,g.jsx)("div",{className:"workspace-mode-selector",children:(0,g.jsx)(o.e,{children:Object.values(T).map(e=>(0,g.jsx)(c.$,{small:!0,active:P.mode===e,onClick:()=>_({type:"SET_MODE",payload:e}),children:e.charAt(0).toUpperCase()+e.slice(1)},e))})})]}),className:"reallocation-workspace",canEscapeKeyClose:!P.isDirty,canOutsideClickClose:!P.isDirty,style:{width:"90vw",maxWidth:"1400px"},children:[(0,g.jsx)("div",{className:r.sar,children:(0,g.jsxs)("div",{className:"workspace-layout",children:[(0,g.jsxs)("div",{className:"workspace-panel passes-panel",children:[(0,g.jsxs)("div",{className:"panel-header",children:[(0,g.jsx)("h3",{children:"Available Passes"}),(0,g.jsxs)("div",{className:"panel-controls",children:[(0,g.jsx)(d.g,{label:"Quality",inline:!0,children:(0,g.jsx)(h.g,{value:D,onChange:e=>L(e.target.value),options:[{value:"all",label:"All"},{value:"excellent",label:"Excellent"},{value:"good",label:"Good"},{value:"fair",label:"Fair"},{value:"poor",label:"Poor"}]})}),(0,g.jsx)(d.g,{label:"Time Window",inline:!0,children:(0,g.jsx)(p.O,{value:b,onValueChange:w,min:1,max:168,rightElement:(0,g.jsx)(m.v,{minimal:!0,children:"hrs"})})}),(0,g.jsx)(v.dO,{checked:M,onChange:e=>W(e.currentTarget.checked),label:"Available only"})]})]}),(0,g.jsx)("div",{className:"passes-list",children:0===V.length?(0,g.jsx)(u.I,{icon:E.W.SATELLITE,title:"No passes available",description:"Try adjusting your filters"}):V.map(e=>{var s,a,i,l,n;return(0,g.jsxs)(A.Z,{className:"pass-card ".concat((null===(s=P.selectedPass)||void 0===s?void 0:s.id)===e.id?"selected":""),interactive:!0,onClick:()=>_({type:"SELECT_PASS",payload:e}),children:[(0,g.jsxs)("div",{className:"pass-header",children:[(0,g.jsx)("strong",{children:e.name}),(0,g.jsx)(m.v,{intent:5===e.quality?x.J.SUCCESS:4===e.quality?x.J.PRIMARY:3===e.quality?x.J.WARNING:x.J.NONE,children:5===e.quality?"Excellent":4===e.quality?"Good":3===e.quality?"Fair":2===e.quality?"Poor":"Unknown"})]}),(0,g.jsxs)("div",{className:"pass-details",children:[(0,g.jsxs)("div",{className:"pass-time",children:[(0,g.jsx)(I,{icon:E.W.TIME,size:12}),(0,g.jsxs)("span",{children:[e.startTime.toLocaleTimeString()," - ",e.endTime.toLocaleTimeString()]}),(0,g.jsxs)(m.v,{minimal:!0,children:[e.duration," min"]})]}),(0,g.jsxs)("div",{className:"pass-metrics",children:[(0,g.jsx)(j.m,{content:"Elevation: ".concat((null===(a=e.elevation)||void 0===a?void 0:a.toFixed(1))||"N/A","\xb0"),children:(0,g.jsxs)(m.v,{minimal:!0,children:[(0,g.jsx)(I,{icon:E.W.TRENDING_UP,size:10}),(null===(i=e.elevation)||void 0===i?void 0:i.toFixed(0))||"N/A","\xb0"]})}),(0,g.jsx)(j.m,{content:"Azimuth: ".concat((null===(l=e.azimuth)||void 0===l?void 0:l.toFixed(1))||"N/A","\xb0"),children:(0,g.jsxs)(m.v,{minimal:!0,children:[(0,g.jsx)(I,{icon:E.W.COMPASS,size:10}),(null===(n=e.azimuth)||void 0===n?void 0:n.toFixed(0))||"N/A","\xb0"]})})]}),e.conflictsWith&&e.conflictsWith.length>0&&(0,g.jsxs)("div",{className:"pass-conflicts",children:[(0,g.jsx)(I,{icon:E.W.WARNING_SIGN,intent:x.J.WARNING,size:12}),(0,g.jsxs)("span",{children:["Conflicts with ",e.conflictsWith.length," passes"]})]})]})]},e.id)})}),P.mode!==T.SIMPLE&&(0,g.jsx)("div",{className:"panel-footer",children:(0,g.jsx)(c.$,{icon:E.W.LIGHTBULB,intent:x.J.PRIMARY,onClick:()=>{const e=P.availablePasses.filter(e=>e.quality>=4).filter(e=>!e.conflictsWith||0===e.conflictsWith.length).slice(0,5).map((e,i)=>({passId:e.id,siteId:a[i%a.length].id,priority:s.priority,timeSlot:{start:e.startTime,end:e.endTime},resources:e.requiredResources||[]})).map(e=>({type:"add",allocation:e,reason:"Auto-optimization"}));_({type:"RESET_CHANGES"}),e.forEach(e=>{_({type:"ADD_ALLOCATION",payload:e.allocation})})},fill:!0,children:"Auto-Optimize Selection"})})]}),(0,g.jsxs)("div",{className:"workspace-panel allocation-panel",children:[(0,g.jsx)("div",{className:"panel-header",children:(0,g.jsx)("h3",{children:"Allocation Configuration"})}),(0,g.jsxs)("div",{className:"allocation-content",children:[(0,g.jsxs)(A.Z,{className:"health-preview",children:[(0,g.jsx)("h4",{children:"Projected Health Impact"}),(0,g.jsx)(C.A,{health:J,showDetails:!0}),(0,g.jsxs)("div",{className:"health-comparison",children:[(0,g.jsxs)("div",{className:"health-metric",children:[(0,g.jsx)("span",{children:"Current Score:"}),(0,g.jsx)("strong",{children:(0,N._H)(s).score})]}),(0,g.jsx)(I,{icon:E.W.ARROW_RIGHT}),(0,g.jsxs)("div",{className:"health-metric",children:[(0,g.jsx)("span",{children:"Projected Score:"}),(0,g.jsx)("strong",{className:J.score>(0,N._H)(s).score?"improvement":"decline",children:J.score})]})]})]}),P.selectedPass&&(0,g.jsxs)(A.Z,{className:"site-selection",children:[(0,g.jsxs)("h4",{children:["Select Site for ",P.selectedPass.name]}),(0,g.jsx)("div",{className:"sites-grid",children:a.map(e=>{var s;const a=(null===(s=P.selectedSite)||void 0===s?void 0:s.id)===e.id,i=(e.capacity-e.allocated)/e.capacity*100;return(0,g.jsxs)(A.Z,{className:"site-option ".concat(a?"selected":""),interactive:!0,onClick:()=>_({type:"SELECT_SITE",payload:e}),children:[(0,g.jsx)("div",{className:"site-name",children:e.name}),(0,g.jsx)(S.z,{value:1-i/100,intent:i<20?x.J.DANGER:x.J.NONE}),(0,g.jsxs)("div",{className:"site-capacity",children:[i.toFixed(0),"% available"]})]},e.id)})}),(0,g.jsx)("div",{className:"allocation-actions",children:(0,g.jsx)(c.$,{intent:x.J.PRIMARY,icon:E.W.ADD,onClick:()=>{if(!P.selectedPass||!P.selectedSite)return void _({type:"SET_VALIDATION_ERRORS",payload:["Please select both a pass and a site"]});const e={passId:P.selectedPass.id,siteId:P.selectedSite.id,priority:s.priority,timeSlot:{start:P.selectedPass.startTime,end:P.selectedPass.endTime},resources:P.selectedPass.requiredResources||[]};_({type:"ADD_ALLOCATION",payload:e}),_({type:"SELECT_PASS",payload:void 0}),_({type:"SET_VALIDATION_ERRORS",payload:[]})},disabled:!P.selectedSite,fill:!0,children:"Allocate Pass to Site"})})]}),P.mode===T.ADVANCED||P.mode===T.EXPERT&&(0,g.jsxs)(A.Z,{className:"advanced-options",children:[(0,g.jsx)("h4",{children:"Advanced Configuration"}),(0,g.jsx)(d.g,{label:"Priority Override",children:(0,g.jsx)(h.g,{options:["low","medium","high","critical"],value:s.priority})}),(0,g.jsxs)(d.g,{label:"Resource Allocation",children:[(0,g.jsx)(v.dO,{label:"Automatic resource management",defaultChecked:!0}),(0,g.jsx)(v.dO,{label:"Allow partial allocations"}),(0,g.jsx)(v.dO,{label:"Enable conflict resolution"})]})]}),P.validationErrors.length>0&&(0,g.jsx)(y.P,{intent:x.J.DANGER,icon:E.W.ERROR,children:P.validationErrors.map((e,s)=>(0,g.jsx)("div",{children:e},s))})]})]}),(0,g.jsxs)("div",{className:"workspace-panel allocations-panel",children:[(0,g.jsxs)("div",{className:"panel-header",children:[(0,g.jsx)("h3",{children:"Current Allocations"}),(0,g.jsxs)(o.e,{children:[(0,g.jsx)(j.m,{content:"Timeline View",children:(0,g.jsx)(c.$,{icon:E.W.TIMELINE_EVENTS,active:P.showTimeline,onClick:()=>_({type:"TOGGLE_TIMELINE"})})}),(0,g.jsx)(j.m,{content:"Show Conflicts",children:(0,g.jsx)(c.$,{icon:E.W.WARNING_SIGN,active:P.showConflicts,onClick:()=>_({type:"TOGGLE_CONFLICTS"})})})]})]}),(0,g.jsx)("div",{className:"allocations-list",children:0===P.proposedChanges.length&&0===P.currentAllocations.length?(0,g.jsx)(u.I,{icon:E.W.INBOX,title:"No allocations",description:"Select passes and sites to create allocations"}):(0,g.jsxs)(g.Fragment,{children:[P.proposedChanges.map((e,s)=>{var i,l;return(0,g.jsxs)(A.Z,{className:"allocation-change ".concat(e.type),children:[(0,g.jsxs)("div",{className:"change-header",children:[(0,g.jsx)(I,{icon:"add"===e.type?E.W.ADD:"remove"===e.type?E.W.REMOVE:E.W.EDIT,intent:"add"===e.type?x.J.SUCCESS:"remove"===e.type?x.J.DANGER:x.J.PRIMARY}),(0,g.jsx)("span",{className:"change-type",children:"add"===e.type?"New Allocation":"remove"===e.type?"Remove Allocation":"Modify Allocation"})]}),(0,g.jsxs)("div",{className:"change-details",children:[(0,g.jsxs)("div",{children:["Pass: ",null===(i=P.availablePasses.find(s=>s.id===e.allocation.passId))||void 0===i?void 0:i.name]}),(0,g.jsxs)("div",{children:["Site: ",null===(l=a.find(s=>s.id===e.allocation.siteId))||void 0===l?void 0:l.name]}),(0,g.jsxs)("div",{children:["Reason: ",e.reason]})]})]},s)}),P.currentAllocations.map(e=>{var s,i;return(0,g.jsxs)(A.Z,{className:"current-allocation",children:[(0,g.jsxs)("div",{className:"allocation-header",children:[(0,g.jsx)("span",{children:null===(s=P.availablePasses.find(s=>s.id===e.passId))||void 0===s?void 0:s.name}),(0,g.jsx)(c.$,{minimal:!0,small:!0,icon:E.W.CROSS,intent:x.J.DANGER,onClick:()=>_({type:"REMOVE_ALLOCATION",payload:e.passId})})]}),(0,g.jsxs)("div",{className:"allocation-details",children:[(0,g.jsxs)("div",{children:["Site: ",null===(i=a.find(s=>s.id===e.siteId))||void 0===i?void 0:i.name]}),(0,g.jsxs)("div",{children:["Priority: ",e.priority]})]})]},e.passId)})]})}),(0,g.jsx)("div",{className:"panel-footer",children:(0,g.jsx)("div",{className:"changes-summary",children:(0,g.jsxs)(m.v,{large:!0,intent:x.J.PRIMARY,children:[P.proposedChanges.length," pending changes"]})})})]})]})}),(0,g.jsx)("div",{className:r.DBf,children:(0,g.jsxs)("div",{className:r.Nu2,children:[(0,g.jsx)(c.$,{onClick:f,disabled:P.isSaving,children:"Cancel"}),P.isDirty&&(0,g.jsx)(c.$,{onClick:()=>_({type:"RESET_CHANGES"}),disabled:P.isSaving,children:"Reset Changes"}),(0,g.jsxs)(c.$,{intent:x.J.PRIMARY,onClick:async()=>{_({type:"START_SAVE"});try{await n(P.proposedChanges),_({type:"SAVE_SUCCESS"}),f()}catch(e){_({type:"SAVE_ERROR"}),_({type:"SET_VALIDATION_ERRORS",payload:["Failed to save changes. Please try again."]})}},disabled:!P.isDirty||P.isSaving,loading:P.isSaving,children:["Apply Changes (",P.proposedChanges.length,")"]})]})})]})}}}]);
//# sourceMappingURL=83905.a979b0e7.chunk.js.map